---
title: "【個人開発】模写を通してWeb制作を学ぶmosyaというサービスを開発した話"
emoji: "👨‍💻"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["nextjs", "typescript", "tailwind", "planetscale", "個人開発", "cloudrun", "cloudflare"]
published: false
---

## どんなサービスか

模写を通してWeb制作の基礎を学ぶmosyaというサービスを開発しました。
専用のエディター内蔵で実際に手を動かして見本を参考にしながら模写をすることで、
体系的にWeb制作を学ぶことができます。

操作感がわかりやすいように動画を用意しましたので、ぜひご覧ください。

@[youtube](https://youtu.be/Hz2Oz1GUKck)


## なぜ作ったのか

### 既存の教材の問題点

Web制作を学ぶ上ですでにたくさんの教材はあるのですが、部分的な知識を学ぶに過ぎない教材が多く、
実際に見本のサイトを完成させられるようになるまでには至らないと感じていました。
なので、なるべく最初は簡単な部品をHTML, CSSでコーディングしていくことでコーディングに慣れていき、
少しずつ難易度を上げていくような教材があればいいなと思い作成しました。

エディターが内蔵されているので、その場でHTMLとCSSのコーディング結果を確認でき見本と比べられるので
動画を見て学習するだけよりも知識がより深まりやすいと思います。

### 学習コストを下げたい

オンラインスクールや学習教材などは、月額数千円から数万円というものが多く、非常に高額なものが多いです。
また、学習教材は一度購入すると期限が切れてしまうものが多いです。
mosyaはなるべくコストを抑え、一度購入すればずっと使い続けられるようにしました。
また、学習教材を使い終わった後もマニュアルが充実しているので辞書がわりとして使うこともできます。

## 使用技術

さて、ここはzennなので、サービスの紹介ではなく、サービスを作る上で使用した技術について紹介します。


### サービス構成図

このサービスを作るにあたって以下のようなサービス構成にしました。

![](https://storage.googleapis.com/zenn-user-upload/2e01ebf382b0-20230503.png)

サービス構成図はこんな感じです。最初は一つのレポジトリで開発しようと思ったのですが、`Cloud Build`のデプロイ時間が長く
ストレスなので、ビルドに時間がかかる **ユーザーのコードを採点する** ためのサービスと **本体のサービス** 、**ユーザーへの連絡用のサービス** に切り分けました。

また、レポジトリも **教材管理用のレポジトリ(mosya-lessons)**、 **本体開発のためのレポジトリ(mosya)** 、 **その他インフラ周りのレポジトリ(mosya-infra)** に分けました。

何名かの方に教材部分を手伝ってもらったのですが、レポジトリを分けたことにより **mosya** 本体のコード内容を知らなくてもマークダウンを書くだけで教材を作成できるようになりました。
結果、学習コストを下げることができその人たちのオンボーディングの時間を短縮できたので、レポジトリを分けてよかったと思っています。

#### Cloudflareの利用

![](https://storage.googleapis.com/zenn-user-upload/de72944ba42c-20230503.png)

Cloudflareは運用コストを下げるためにとても重宝します。例えば、Cloudflareのキャッシュ機能を使うことで、あまり更新がないAPIや画像、その他アセットなどのファイルをキャッシュすることで、直接、サーバーである`Cloud Run`が叩かれる機会を減らすことができます。

画像は、Cloudflareの`R2`を利用してそこにカスタムドメインを当てることでリクエスト時間を短縮することに成功しています。

#### PlanetScaleの利用

PlanetScaleは開発用と本番用でDBのブランチを切り替えることができるのでとても便利です。`staging`環境用の開発ブランチである`development`から本番環境のブランチである`master`にマージすることで、本番環境のDBにステージング環境のDBのスキーマを簡単に反映することができます。

`GitHub Actions`を使っているのですが、公式が出しているサンプルを利用することで簡単に実装できました。

https://github.com/planetscale/deploy-deploy-request-action

こんな感じで、自動でPlanet Scaleでスキーマのマージリクエストが作成されマージされるようになっています。

![](https://storage.googleapis.com/zenn-user-upload/e1137886971e-20230503.png)

ワークフローの中でスキーマの反映が行えるのは非常に便利ですね！

#### Github Actionsの利用

サービス本体は`Cloud Build`でデプロイしていますが、その他の部分では`Cloud Build`だとデプロイ時間が長くストレスなので、`Github Actions`を利用しています。

`GitHub Actions`を使えば`git`の操作が楽に行えるので教材の反映などは差分があったファイルから、教材の反映に必要な処理だけを抽出して必要に応じて`DB`に更新をかけたり`Cloudflare`の`R2`に画像をアップロードしたりしています。

### フロントエンド

今回サービスを作るにあたってフロントエンドには特に力を入れました。



